(()=>{"use strict";class e{setDisplayValue(t,s,i){e.mainDisplayDom.innerHTML=t.toString(),e.displayIncomeTotal.innerHTML=s.toString(),e.displayExpenseTotal.innerHTML=i.toString()}addBudgetItems(e,t){"income"==t&&console.log(e),"expense"==t&&console.log(e)}clearField(){e.descriptionDom.value=null,e.amountDom.value=null,e.descriptionDom.focus()}static formValidation(){""==e.descriptionDom.value||null==e.descriptionDom.value||""==e.amountDom.value||null==e.amountDom.value?e.submit.disabled=!0:e.submit.disabled=!1}budgetCardHtml(e,t,s,i){return`<div id="${t}" class="card mb-3"> <div class="card-header text-center d-flex justify-content-between"><span class="pl-5">${t}</span><span id="inc-${t}"  class="delete-button">X</span></div>\n    <div class="card-body"><ul class="list-group"><li class="list-group-item">${s}</li><li class="list-group-item list-group-item-${e?"success":"danger"}">$<span>${i}</span></li></ul> <button class="btn btn-dark mt-3" style="\n    ">Edit</button> </div></div>`}addToIncome(t){t.length>0&&(e.incomeColumn.innerHTML="",t.forEach((t=>{e.incomeColumn.innerHTML+=this.budgetCardHtml(!0,t.id,t.description,t.amount)}))),this.clearField()}clearColumns(){e.expenseColumn.innerHTML="",e.incomeColumn.innerHTML=""}addToExpense(t){console.log(t),t.length>0&&(e.expenseColumn.innerHTML="",t.forEach((t=>{e.expenseColumn.innerHTML+=this.budgetCardHtml(!1,t.id,t.description,t.amount)}))),this.clearField()}}e.mainDisplayDom=document.getElementById("main-display"),e.displayIncomeTotal=document.getElementById("income-display"),e.displayExpenseTotal=document.getElementById("expense-display"),e.expenseColumn=document.getElementById("expense-column"),e.incomeColumn=document.getElementById("income-column"),e.descriptionDom=document.getElementById("description"),e.amountDom=document.getElementById("amount"),e.type=document.getElementById("type"),e.submit=document.getElementById("submit"),e.email_login=document.getElementById("email_login"),e.email_register=document.getElementById("email_register"),e.password_login=document.getElementById("password_login"),e.password_register=document.getElementById("password_register"),e.submit_user_register=document.getElementById("submit_user_register"),e.submit_user_login=document.getElementById("submit_user_login"),e.closeSignInBtn=document.getElementById("close-signin"),e.closeRegisterBtn=document.getElementById("close-signup");class t{constructor(e,t,s,i,l,n){this.id=e,this.userId=t,this.date=s,this.description=i,this.amount=l,this.type=n}}const s="https://localhost:7242/api/Users/",i="https://localhost:7242/api/Budget/",l="https://localhost:7242/api/Budget/get_last_item/";var n=function(e,t,s,i){return new(s||(s=Promise))((function(l,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?l(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))};class o{get(){return fetch(i).then((e=>e.json())).then((e=>e)).catch((e=>console.error(e)))}getLastItem(e){return fetch(l+e).then((e=>e.json())).then((e=>e)).catch((e=>console.error(e)))}put(e,t){console.log(`id:${e} ${t}`)}post(e){return n(this,void 0,void 0,(function*(){delete e.id,delete e.date,console.log("Post ran"),yield fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.userId,description:e.description,amount:e.amount,type:e.type})}).then((e=>e.json()))}))}delete(e){return n(this,void 0,void 0,(function*(){console.log("delete request sent"),yield fetch(i+e,{method:"DELETE"}).then((e=>e.json)).then((e=>console.log(e)))}))}}class a{constructor(e,t,s){this.dal=new o,this.uuid=()=>"xxxxxxxx-4xxx-yxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),this.total=e,this.expenseTotal=t,this.incomeTotal=s,this.allExp=[],this.allinc=[]}setTotals(e,t){"income"==t&&(this.incomeTotal+=e,this.total+=e),"expense"==t&&(this.expenseTotal+=e,this.total-=e)}incomeDelete(){for(let t=0;t<e.incomeColumn.children.length;t++){let s=e.incomeColumn.children[t].children[0].children[1].id;document.getElementById(s).addEventListener("click",(()=>{this.allinc.forEach((t=>{if(parseInt(s.split("-",2)[1])==t.id){let s=this.allinc.indexOf(t);this.allinc.splice(s,1),e.incomeColumn.removeChild(e.incomeColumn.children[s]),this.dal.delete(parseInt(t.id))}}))}))}}expenseDelete(){for(let t=0;t<e.expenseColumn.children.length;t++){let s=e.expenseColumn.children[t].children[0].children[1].id;document.getElementById(s).addEventListener("click",(()=>{this.allExp.forEach((t=>{if(parseInt(s.split("-",2)[1])==t.id){let s=this.allExp.indexOf(t);this.allExp.splice(s,1),e.expenseColumn.removeChild(e.expenseColumn.children[s]),this.dal.delete(parseInt(t.id))}}))}))}}eventListenersDelete(){this.expenseDelete(),this.incomeDelete()}getTotals(){return{total:this.total,expenseTotal:this.expenseTotal,incomeTotal:this.incomeTotal}}clearAllData(){this.total=0,this.allExp=[],this.allinc=[],this.expenseTotal=0,this.incomeTotal=0}calculateTotals(){this.allExp.forEach((e=>{this.setTotals(e.amount,e.type)})),this.allinc.forEach((e=>{this.setTotals(e.amount,e.type)}))}getAllExp(){return this.allExp}getAllInc(){return this.allinc}saveDataToArr(e,s,i,l,n,o){console.log(i);let a=new t(e,s,i,l,n,o);"expense"==o&&this.allExp.push(a),"income"==o&&this.allinc.push(a)}}class d{constructor(e,t){this.email=e,this.password=t}}class r extends d{}class c{constructor(e){this.apiUrl=e}RegisterUser(e){fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password})}).then((e=>e.json()))}LoginUser(e){return fetch("https://localhost:7242/api/Users/get_user_id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password})}).then((e=>e.json())).then((e=>e)).catch((e=>console.error(e)))}}const m=new class{setUserId(e){this.userId=e}setAllExp(e){this.allExp=e}setAllInc(e){this.allInc=e}setTotal(e){this.total=e}};var h=function(e,t,s,i){return new(s||(s=Promise))((function(l,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?l(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((i=i.apply(e,t||[])).next())}))};class u{constructor(t,i,l,n){this.userDal=new c(s),this.view=new e,this.model=new a(0,0,0),this.registerEmail=t,this.registerPassword=i,this.loginEmail=l,this.loginPassword=n}getUserId(){return this.userId}loadFromDb(e){return h(this,void 0,void 0,(function*(){let t=new o;this.userId=e,(yield t.get()).forEach((e=>{this.model.saveDataToArr(e.id,this.userId,e.date,e.description,e.amount,e.type),this.view.addToIncome(this.model.getAllInc()),this.view.addToExpense(this.model.getAllExp()),this.model.setTotals(e.amount,e.type)})),m.userId=parseInt(e),m.allExp=this.model.getAllExp(),m.allInc=this.model.getAllInc(),m.total=this.model.getTotals().total,m.expenseTotal=this.model.getTotals().expenseTotal,m.incomeTotal=this.model.getTotals().incomeTotal,this.view.setDisplayValue(this.model.total,this.model.incomeTotal,this.model.expenseTotal),this.model.eventListenersDelete()}))}registerUser(){this.userDal.RegisterUser(new r(this.registerEmail.value,this.registerPassword.value)),this.view.clearColumns(),this.model.clearAllData(),e.closeRegisterBtn.click()}signUserIn(){return h(this,void 0,void 0,(function*(){this.userId=JSON.stringify(yield this.userDal.LoginUser(new d(this.loginEmail.value,this.loginPassword.value))).toString(),this.view.clearColumns(),this.model.clearAllData(),this.loadFromDb(this.userId),this.loginEmail.value=null,this.loginPassword.value=null,e.closeSignInBtn.click()}))}}(new class{constructor(){this.model=new a(0,0,0),this.view=new e,this.apiUrlBudget=i,this.dal=new o,this.userForm=new u(e.email_register,e.password_register,e.email_login,e.password_login)}guestMode(){}userAccountMode(){}syncModelWithState(){this.model.userId=m.userId,this.model.allExp=m.allExp,this.model.allinc=m.allInc,this.model.total=m.total,this.model.incomeTotal=m.incomeTotal,this.model.expenseTotal=m.expenseTotal}syncStateWithModel(){m.userId=this.model.userId,m.allExp=this.model.allExp,m.allInc=this.model.allinc,m.total=this.model.total,m.incomeTotal=this.model.incomeTotal,m.expenseTotal=this.model.expenseTotal}postToDb(){return s=this,i=void 0,n=function*(){let s=parseInt(e.amountDom.value);yield this.dal.post(new t(null,this.model.userId,null,e.descriptionDom.value,s,e.type.value)),this.getLastItem()},new((l=void 0)||(l=Promise))((function(e,t){function o(e){try{d(n.next(e))}catch(e){t(e)}}function a(e){try{d(n.throw(e))}catch(e){t(e)}}function d(t){var s;t.done?e(t.value):(s=t.value,s instanceof l?s:new l((function(e){e(s)}))).then(o,a)}d((n=n.apply(s,i||[])).next())}));var s,i,l,n}getLastItem(){let t=parseInt(e.amountDom.value);this.dal.getLastItem(this.model.userId).then((s=>{this.model.saveDataToArr(s.id,s.userId,s.date,s.description,s.amount,s.type),this.model.setTotals(t,e.type.value),this.view.setDisplayValue(this.model.total,this.model.incomeTotal,this.model.expenseTotal),this.view.addToIncome(this.model.getAllInc()),this.view.addToExpense(this.model.getAllExp()),this.syncStateWithModel(),console.log(m),this.model.eventListenersDelete()}))}init(){this.view.setDisplayValue(this.model.total,this.model.incomeTotal,this.model.expenseTotal),e.submit.addEventListener("click",(()=>{this.syncModelWithState(),e.submit.disabled=!0,this.model.userId=parseInt(this.userForm.getUserId()),this.postToDb()})),e.descriptionDom.addEventListener("keyup",(function(){e.formValidation()})),e.amountDom.addEventListener("keyup",(function(){e.formValidation()})),e.submit.disabled=!0,e.submit_user_register.addEventListener("click",(e=>{e.preventDefault(),this.userForm.registerUser(),console.log(this.userForm)})),e.submit_user_login.addEventListener("click",(e=>{e.preventDefault(),this.userForm.signUserIn()}))}}).init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUttRyxTQUFTSixlQUNkbkgsUUFBUUMsSUFBSW1CLEtBQUttRyxhQUluQnBJLEVBQUs0QyxrQkFBa0IyQyxpQkFBaUIsU0FBU3ZELElBQy9DQSxFQUFFNEcsaUJBQ0YzRyxLQUFLbUcsU0FBU0YsbUJEbkpUUSxRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYnVkZ2V0Ly4vc2NyaXB0cy92aWV3LnRzIiwid2VicGFjazovL2J1ZGdldC8uL3NjcmlwdHMvTW9kZWxzL0J1ZGdldEl0ZW1Nb2RlbC50cyIsIndlYnBhY2s6Ly9idWRnZXQvLi9zY3JpcHRzL0RBTC9BcGlFbmRQb2ludHMudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0Ly4vc2NyaXB0cy9EQUwvQnVkZ2V0RGFsLnRzIiwid2VicGFjazovL2J1ZGdldC8uL3NjcmlwdHMvbW9kZWwudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0Ly4vc2NyaXB0cy9Nb2RlbHMvTG9naW5Gb3JtTW9kZWwudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0Ly4vc2NyaXB0cy9Nb2RlbHMvUmVnaXN0ZXJGb3JtTW9kZWwudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0Ly4vc2NyaXB0cy9EQUwvVXNlckRhbC50cyIsIndlYnBhY2s6Ly9idWRnZXQvLi9zY3JpcHRzL1N0b3JlL0FwcFN0YXRlLnRzIiwid2VicGFjazovL2J1ZGdldC8uL3NjcmlwdHMvdXNlckZvcm0udHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0Ly4vc2NyaXB0cy9tYWluLnRzIiwid2VicGFjazovL2J1ZGdldC8uL3NjcmlwdHMvY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCdWRnZXRJdGVtIH0gZnJvbSBcIi4vTW9kZWxzL0J1ZGdldEl0ZW1Nb2RlbFwiO1xuXG5cblxuZXhwb3J0IGNsYXNzIFZpZXd7XG5cbnB1YmxpYyBzdGF0aWMgbWFpbkRpc3BsYXlEb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbi1kaXNwbGF5JykgYXMgSFRNTEVsZW1lbnQ7ICBcbnB1YmxpYyBzdGF0aWMgZGlzcGxheUluY29tZVRvdGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luY29tZS1kaXNwbGF5JykgYXMgSFRNTEVsZW1lbnQ7XG5wdWJsaWMgc3RhdGljIGRpc3BsYXlFeHBlbnNlVG90YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwZW5zZS1kaXNwbGF5JykgYXMgSFRNTEVsZW1lbnQ7XG5wdWJsaWMgc3RhdGljIGV4cGVuc2VDb2x1bW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwZW5zZS1jb2x1bW4nKSBhcyBIVE1MRWxlbWVudDtcbnB1YmxpYyBzdGF0aWMgaW5jb21lQ29sdW1uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luY29tZS1jb2x1bW4nKSBhcyBIVE1MRWxlbWVudDtcbnB1YmxpYyBzdGF0aWMgZGVzY3JpcHRpb25Eb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xucHVibGljIHN0YXRpYyBhbW91bnREb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW1vdW50JykgYXMgSFRNTElucHV0RWxlbWVudDtcbnB1YmxpYyBzdGF0aWMgdHlwZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0eXBlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbnB1YmxpYyBzdGF0aWMgc3VibWl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1Ym1pdCcpIGFzIEhUTUxCdXR0b25FbGVtZW50IDtcblxucHVibGljIHN0YXRpYyBlbWFpbF9sb2dpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbWFpbF9sb2dpbicpIGFzIEhUTUxGb3JtRWxlbWVudFxucHVibGljIHN0YXRpYyBlbWFpbF9yZWdpc3RlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbWFpbF9yZWdpc3RlcicpIGFzIEhUTUxGb3JtRWxlbWVudFxuXG5wdWJsaWMgc3RhdGljIHBhc3N3b3JkX2xvZ2luID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwYXNzd29yZF9sb2dpblwiKSBhcyBIVE1MRm9ybUVsZW1lbnRcbnB1YmxpYyBzdGF0aWMgcGFzc3dvcmRfcmVnaXN0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBhc3N3b3JkX3JlZ2lzdGVyXCIpIGFzIEhUTUxGb3JtRWxlbWVudFxuXG5wdWJsaWMgc3RhdGljIHN1Ym1pdF91c2VyX3JlZ2lzdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1Ym1pdF91c2VyX3JlZ2lzdGVyJykgYXMgSFRNTEZvcm1FbGVtZW50O1xucHVibGljIHN0YXRpYyBzdWJtaXRfdXNlcl9sb2dpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdWJtaXRfdXNlcl9sb2dpbicpIGFzIEhUTUxGb3JtRWxlbWVudDtcbnB1YmxpYyBzdGF0aWMgY2xvc2VTaWduSW5CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlLXNpZ25pblwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbnB1YmxpYyBzdGF0aWMgY2xvc2VSZWdpc3RlckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2Utc2lnbnVwXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXG5cbiAgc2V0RGlzcGxheVZhbHVlKG1haW5EaXNwbGF5Om51bWJlcixpbmNvbWVUb3RhbDpudW1iZXIsZXhwZW5zZVRvdGFsOm51bWJlcik6dm9pZFxuICB7XG4gICAgLy8gU2V0cyB0aGUgZGlzcGxheSB2YWx1ZVxuICAgIFZpZXcubWFpbkRpc3BsYXlEb20uaW5uZXJIVE1MID0gbWFpbkRpc3BsYXkudG9TdHJpbmcoKTtcbiAgICBWaWV3LmRpc3BsYXlJbmNvbWVUb3RhbC5pbm5lckhUTUwgPSBpbmNvbWVUb3RhbC50b1N0cmluZygpO1xuICAgIFZpZXcuZGlzcGxheUV4cGVuc2VUb3RhbC5pbm5lckhUTUwgPSBleHBlbnNlVG90YWwudG9TdHJpbmcoKTtcbiAgfVxuXG4gIGFkZEJ1ZGdldEl0ZW1zKGRhdGE6b2JqZWN0LCB0eXBlOnN0cmluZyk6dm9pZFxuICB7XG4gICAgaWYodHlwZSA9PSAnaW5jb21lJylcbiAgICB7XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICB9XG4gICAgXG4gICAgaWYodHlwZSA9PSAnZXhwZW5zZScpXG4gICAge1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJGaWVsZCgpOnZvaWR7XG4gICAgVmlldy5kZXNjcmlwdGlvbkRvbS52YWx1ZSA9IG51bGw7XG4gICAgVmlldy5hbW91bnREb20udmFsdWUgPSBudWxsO1xuXG4gICAgVmlldy5kZXNjcmlwdGlvbkRvbS5mb2N1cygpXG4gIH1cblxuIFxuXG4gIHN0YXRpYyBmb3JtVmFsaWRhdGlvbigpOnZvaWR7XG4gICAgICBpZihWaWV3LmRlc2NyaXB0aW9uRG9tLnZhbHVlID09IFwiXCIgfHwgVmlldy5kZXNjcmlwdGlvbkRvbS52YWx1ZSA9PSBudWxsIHx8IFZpZXcuYW1vdW50RG9tLnZhbHVlID09IFwiXCIgfHwgVmlldy5hbW91bnREb20udmFsdWUgPT0gbnVsbCl7XG4gICAgICAgIFZpZXcuc3VibWl0LmRpc2FibGVkID0gdHJ1ZVxuICAgICAgfWVsc2V7XG4gICAgICAgIFZpZXcuc3VibWl0LmRpc2FibGVkID0gZmFsc2VcbiAgICAgIH1cbiAgfVxuXG4gIGJ1ZGdldENhcmRIdG1sKGluY29tZTpib29sZWFuLCBpZDpudW1iZXIgfCBzdHJpbmcsIGRlc2NyaXB0aW9uOnN0cmluZywgYW1vdW50OnN0cmluZyB8IG51bWJlcik6c3RyaW5ne1xuICAgIHJldHVybiBgPGRpdiBpZD1cIiR7aWR9XCIgY2xhc3M9XCJjYXJkIG1iLTNcIj4gPGRpdiBjbGFzcz1cImNhcmQtaGVhZGVyIHRleHQtY2VudGVyIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlblwiPjxzcGFuIGNsYXNzPVwicGwtNVwiPiR7aWR9PC9zcGFuPjxzcGFuIGlkPVwiaW5jLSR7aWR9XCIgIGNsYXNzPVwiZGVsZXRlLWJ1dHRvblwiPlg8L3NwYW4+PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImNhcmQtYm9keVwiPjx1bCBjbGFzcz1cImxpc3QtZ3JvdXBcIj48bGkgY2xhc3M9XCJsaXN0LWdyb3VwLWl0ZW1cIj4ke2Rlc2NyaXB0aW9ufTwvbGk+PGxpIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtIGxpc3QtZ3JvdXAtaXRlbS0ke2luY29tZSA/ICdzdWNjZXNzJyA6ICdkYW5nZXInfVwiPiQ8c3Bhbj4ke2Ftb3VudH08L3NwYW4+PC9saT48L3VsPiA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1kYXJrIG10LTNcIiBzdHlsZT1cIlxuICAgIFwiPkVkaXQ8L2J1dHRvbj4gPC9kaXY+PC9kaXY+YFxuICB9XG5cbiAgYWRkVG9JbmNvbWUoZGF0YSk6dm9pZHtcbiAgICAvL2FkZCB0byBpbmNvbWUgY29sdW1uXG4gICAgaWYoZGF0YS5sZW5ndGggPiAwKXtcbiAgICAgIFZpZXcuaW5jb21lQ29sdW1uLmlubmVySFRNTCA9IFwiXCJcbiAgICAgIGRhdGEuZm9yRWFjaCgoZTpCdWRnZXRJdGVtKSA9PiB7XG4gICAgICAgIFZpZXcuaW5jb21lQ29sdW1uLmlubmVySFRNTCArPSB0aGlzLmJ1ZGdldENhcmRIdG1sKHRydWUgLGUuaWQsIGUuZGVzY3JpcHRpb24sIGUuYW1vdW50KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgfVxuICAgIFxuICAgIHRoaXMuY2xlYXJGaWVsZCgpXG4gIH1cblxuICBcblxuICBjbGVhckNvbHVtbnMoKTp2b2lke1xuICAgIFZpZXcuZXhwZW5zZUNvbHVtbi5pbm5lckhUTUwgPSBcIlwiO1xuICAgIFZpZXcuaW5jb21lQ29sdW1uLmlubmVySFRNTCA9IFwiXCI7XG4gIH1cblxuICBhZGRUb0V4cGVuc2UoZGF0YSk6dm9pZHtcbiAgICAvL2FkZCB0byBleHBlbnNlIGluY29tZVxuICAgIGNvbnNvbGUubG9nKGRhdGEpXG5cbiAgICBpZihkYXRhLmxlbmd0aCA+IDApe1xuICAgICAgVmlldy5leHBlbnNlQ29sdW1uLmlubmVySFRNTCA9IFwiXCJcbiAgICAgIGRhdGEuZm9yRWFjaCgoZTpCdWRnZXRJdGVtKSAgPT4ge1xuICAgICAgICBWaWV3LmV4cGVuc2VDb2x1bW4uaW5uZXJIVE1MICs9IHRoaXMuYnVkZ2V0Q2FyZEh0bWwoZmFsc2UgLGUuaWQsIGUuZGVzY3JpcHRpb24sIGUuYW1vdW50KTtcblxuICAgICAgfSk7XG4gICAgICBcbiAgICB9XG4gICAgdGhpcy5jbGVhckZpZWxkKClcbiAgICBcbiAgfVxuXG5cblxuXG59IiwiaW1wb3J0IHtCdWRnZXREYXRhSW50ZXJmYWNlfSBmcm9tIFwiLi4vSW50ZXJmYWNlcy9JbnRlcmZhY2VzXCJcblxuXG5leHBvcnQgY2xhc3MgQnVkZ2V0SXRlbSBpbXBsZW1lbnRzIEJ1ZGdldERhdGFJbnRlcmZhY2Uge1xuICAgIGlkOm51bWJlciB8IHN0cmluZyB8IG51bGw7XG4gICAgdXNlcklkOiBudW1iZXI7XG4gICAgZGF0ZTpzdHJpbmcgfCBEYXRlO1xuICAgIGRlc2NyaXB0aW9uOnN0cmluZztcbiAgICBhbW91bnQ6bnVtYmVyO1xuICAgIHR5cGU6c3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoaWQ6c3RyaW5nLHVzZXJJZDpudW1iZXIsZGF0ZTpzdHJpbmcgfCBEYXRlLGRlc2M6c3RyaW5nLGFtb3VudDpudW1iZXIsdHlwZTpzdHJpbmcpe1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkO1xuICAgICAgICB0aGlzLmRhdGUgPSBkYXRlO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzYztcbiAgICAgICAgdGhpcy5hbW91bnQgPSBhbW91bnQ7XG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGVcblxuICAgIH1cbn0iLCJcbmNvbnN0IEFwaUVuZFBvaW50cyA9IHtcbiAgICB1c2VyczpcImh0dHBzOi8vbG9jYWxob3N0OjcyNDIvYXBpL1VzZXJzL1wiLFxuICAgIGJ1ZGdldDpcImh0dHBzOi8vbG9jYWxob3N0OjcyNDIvYXBpL0J1ZGdldC9cIixcbiAgICBnZXRVc2VySXRlbXM6XCJodHRwczovL2xvY2FsaG9zdDo3MjQyL2FwaS9CdWRnZXQvZ2V0X3VzZXJfaXRlbXMvXCIsXG4gICAgZ2V0TGFzdEl0ZW06XCJodHRwczovL2xvY2FsaG9zdDo3MjQyL2FwaS9CdWRnZXQvZ2V0X2xhc3RfaXRlbS9cIlxuICAgIFxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGlFbmRQb2ludHM7IiwiLy8gQ3JlYXRlIGNvbm5lY3Rpb25zIHRvIGFwaVxuaW1wb3J0IHsgQnVkZ2V0SXRlbSB9IGZyb20gXCIuLi9Nb2RlbHMvQnVkZ2V0SXRlbU1vZGVsXCJcbmltcG9ydCB7IGJ1ZGdldEludGVyZmFjZSB9IGZyb20gXCIuLi9JbnRlcmZhY2VzL0ludGVyZmFjZXNcIlxuaW1wb3J0IEFwaUVuZFBvaW50cyBmcm9tIFwiLi9BcGlFbmRQb2ludHNcIjtcblxuXG5leHBvcnQgY2xhc3MgRGF0YUFjY2Vzc0xheWVyIHtcbiAgICBcblxuICAgIGdldCgpOlByb21pc2U8QnVkZ2V0SXRlbVtdPntcbiAgICAgcmV0dXJuIGZldGNoKEFwaUVuZFBvaW50cy5idWRnZXQpXG4gICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG5cbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcbiAgICB9XG5cbiAgICBnZXRMYXN0SXRlbShpZDpudW1iZXIpOlByb21pc2U8QnVkZ2V0SXRlbT57XG4gICAgICByZXR1cm4gZmV0Y2goQXBpRW5kUG9pbnRzLmdldExhc3RJdGVtK2lkKVxuICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAgICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICB9XG5cbiAgICBwdXQoaWQ6bnVtYmVyLGl0ZW06QnVkZ2V0SXRlbSk6dm9pZHtcbiAgICAgIGNvbnNvbGUubG9nKGBpZDoke2lkfSAke2l0ZW19YClcbiAgICB9XG5cbiAgICBhc3luYyBwb3N0KGl0ZW06QnVkZ2V0SXRlbSl7XG4gICAgICAvLyBpZCBhbmQgZGF0ZSBpcyByZW1vdmVkIGZyb20gb2JqZWN0cyBiZWNhdXNlIGRhdGFiYXNlIHdpbGwgYXNzaWduIHZhbHVlc1xuICAgICAgZGVsZXRlIGl0ZW0uaWRcbiAgICAgIGRlbGV0ZSBpdGVtLmRhdGVcbiAgICAgIGNvbnNvbGUubG9nKFwiUG9zdCByYW5cIilcblxuICAgICBhd2FpdCBmZXRjaChBcGlFbmRQb2ludHMuYnVkZ2V0LCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgJ3VzZXJJZCc6IGl0ZW0udXNlcklkLFxuICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzppdGVtLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgJ2Ftb3VudCc6aXRlbS5hbW91bnQsXG4gICAgICAgICAgICAndHlwZSc6aXRlbS50eXBlXG5cblxuICAgICAgICB9KSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSlcbiAgICB9XG5cbiAgIGFzeW5jIGRlbGV0ZShpZDpudW1iZXIpe1xuICAgICBjb25zb2xlLmxvZyhcImRlbGV0ZSByZXF1ZXN0IHNlbnRcIilcbiAgICAgIGF3YWl0IGZldGNoKEFwaUVuZFBvaW50cy5idWRnZXQgKyBpZCwge1xuICAgICAgICBtZXRob2Q6ICdERUxFVEUnXG4gICAgICAgXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbilcbiAgICAgICAgLnRoZW4ocmVzID0+IGNvbnNvbGUubG9nKHJlcykpXG4gICAgfVxufSIsImltcG9ydCB7XG4gICAgQnVkZ2V0RGF0YUludGVyZmFjZSxcbiAgICBtb2RlbEludGVyZmFjZVxufSBmcm9tIFwiLi9JbnRlcmZhY2VzL0ludGVyZmFjZXNcIlxuXG5cbmltcG9ydCB7IEJ1ZGdldEl0ZW0gfSBmcm9tIFwiLi9Nb2RlbHMvQnVkZ2V0SXRlbU1vZGVsXCI7XG5cbmltcG9ydCB7XG4gICAgRGF0YUFjY2Vzc0xheWVyXG59IGZyb20gXCIuL0RBTC9CdWRnZXREYWxcIjtcbmltcG9ydCB7XG4gICAgVmlld1xufSBmcm9tIFwiLi92aWV3XCI7XG5cblxuXG5leHBvcnQgY2xhc3MgTW9kZWwgaW1wbGVtZW50cyBtb2RlbEludGVyZmFjZSB7XG4gICAgLy8gVXNlciBnZXR0ZXJzIGFuZCBzZXR0ZXJzIHRvIGFjY2VzcyBkYXRhXG4gICAgLy8gVGFrZXMgdmFsdWVzIGZyb20gY29udHJvbGxlciBhbmQgZ2l2ZXMgaXQgdG8gaW5jb21lIGFuZCBleHBlbnNlIG9iamVjdFxuICAgIHVzZXJJZDogbnVtYmVyO1xuICAgIGFsbEV4cDogQnVkZ2V0RGF0YUludGVyZmFjZVtdO1xuICAgIGFsbGluYzogQnVkZ2V0RGF0YUludGVyZmFjZVtdO1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgZXhwZW5zZVRvdGFsOiBudW1iZXI7XG4gICAgaW5jb21lVG90YWw6IG51bWJlcjtcbiAgICBkYWw6IERhdGFBY2Nlc3NMYXllciA9IG5ldyBEYXRhQWNjZXNzTGF5ZXIoKTtcblxuICAgIGNvbnN0cnVjdG9yKHRvdGFsOiBudW1iZXIsIGV4cGVuc2VUb3RhbDogbnVtYmVyLCBpbmNvbWVUb3RhbDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcbiAgICAgICAgdGhpcy5leHBlbnNlVG90YWwgPSBleHBlbnNlVG90YWw7XG4gICAgICAgIHRoaXMuaW5jb21lVG90YWwgPSBpbmNvbWVUb3RhbDtcbiAgICAgICAgdGhpcy5hbGxFeHAgPSBbXTtcbiAgICAgICAgdGhpcy5hbGxpbmMgPSBbXTtcbiAgICB9XG5cblxuICAgIHNldFRvdGFscyh2YWx1ZTogbnVtYmVyLCB0eXBlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgLy8gVG90YWxzIGFyZSBjYWxjdWxhdGVkIGluIGNvbnRyb2xsZXJcblxuICAgICAgICBpZiAodHlwZSA9PSAnaW5jb21lJykge1xuICAgICAgICAgICAgdGhpcy5pbmNvbWVUb3RhbCArPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudG90YWwgKz0gdmFsdWU7XG5cbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKHR5cGUgPT0gJ2V4cGVuc2UnKSB7XG4gICAgICAgICAgICB0aGlzLmV4cGVuc2VUb3RhbCArPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudG90YWwgLT0gdmFsdWU7XG4gICAgICAgIH1cblxuXG5cbiAgICB9XG5cbiAgICBpbmNvbWVEZWxldGUoKTogdm9pZCB7XG4gICAgICAgIC8vTG9vcHMgdGhyb3VnaCBpbmNvbWUgY29sdW1uIGdldCBhbGwgaWRcbiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IFZpZXcuaW5jb21lQ29sdW1uLmNoaWxkcmVuLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgbGV0IGlkID0gVmlldy5pbmNvbWVDb2x1bW4uY2hpbGRyZW5baW5kZXhdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzFdLmlkO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblxuICAgICAgICAgICAgICAgIC8vTG9vcHMgdGhyb3VnaCBleHBlbnNlIGNvbHVtbiB0byByZW1vdmUgaXRlbSB0aGF0IG1hdGNoZXMgaWRcbiAgICAgICAgICAgICAgICB0aGlzLmFsbGluYy5mb3JFYWNoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZWxlbWVudElkID0gcGFyc2VJbnQoaWQuc3BsaXQoXCItXCIsIDIpWzFdKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudElkID09IGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpdGVtSW5kZXggPSB0aGlzLmFsbGluYy5pbmRleE9mKGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbGluYy5zcGxpY2UoaXRlbUluZGV4LCAxKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBWaWV3LmluY29tZUNvbHVtbi5yZW1vdmVDaGlsZChWaWV3LmluY29tZUNvbHVtbi5jaGlsZHJlbltpdGVtSW5kZXhdKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYWwuZGVsZXRlKHBhcnNlSW50KGUuaWQpKVxuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgfSlcblxuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIGV4cGVuc2VEZWxldGUoKTogdm9pZCB7XG4gICAgICAgIC8vTG9vcHMgdGhyb3VnaCBleHBlbnNlIGNvbHVtbiBnZXQgYWxsIGlkXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBWaWV3LmV4cGVuc2VDb2x1bW4uY2hpbGRyZW4ubGVuZ3RoOyBpbmRleCsrKSB7XG5cbiAgICAgICAgICAgIGxldCBpZCA9IFZpZXcuZXhwZW5zZUNvbHVtbi5jaGlsZHJlbltpbmRleF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMV0uaWQ7XG5cbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgLy9Mb29wcyB0aHJvdWdoIGV4cGVuc2UgY29sdW1uIHRvIHJlbW92ZSBpdGVtIHRoYXQgbWF0Y2hlcyBpZFxuICAgICAgICAgICAgICAgIHRoaXMuYWxsRXhwLmZvckVhY2goZSA9PiB7XG4gICAgICAgICAgICAgICAgICBsZXQgZWxlbWVudElkID0gcGFyc2VJbnQoaWQuc3BsaXQoXCItXCIsIDIpWzFdKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudElkID09IGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpdGVtSW5kZXggPSB0aGlzLmFsbEV4cC5pbmRleE9mKGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbEV4cC5zcGxpY2UoaXRlbUluZGV4LCAxKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBWaWV3LmV4cGVuc2VDb2x1bW4ucmVtb3ZlQ2hpbGQoVmlldy5leHBlbnNlQ29sdW1uLmNoaWxkcmVuW2l0ZW1JbmRleF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYWwuZGVsZXRlKHBhcnNlSW50KGUuaWQpKVxuICAgICAgICAgICAgICAgICAgICB9ICAgXG5cblxuICAgICAgICAgICAgICAgIH0pXG5cblxuXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGV2ZW50TGlzdGVuZXJzRGVsZXRlKCkge1xuICAgICAgICB0aGlzLmV4cGVuc2VEZWxldGUoKTtcbiAgICAgICAgdGhpcy5pbmNvbWVEZWxldGUoKTtcbiAgICB9XG5cblxuXG4gICAgLy8gQ3JlYXRlcyBVbmlxdWUgSUQgZm9yIG9iamVjdFxuICAgIHV1aWQgPSAoKSA9PlxuICAgIFwieHh4eHh4eHgtNHh4eC15eHh4XCIucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICB2YXIgciA9IChNYXRoLnJhbmRvbSgpICogMTYpIHwgMCxcbiAgICAgICAgICAgIHYgPSBjID09IFwieFwiID8gciA6IChyICYgMHgzKSB8IDB4ODtcbiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICAgIH0pO1xuXG4gICAgZ2V0VG90YWxzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG90YWw6IHRoaXMudG90YWwsXG4gICAgICAgICAgICBleHBlbnNlVG90YWw6IHRoaXMuZXhwZW5zZVRvdGFsLFxuICAgICAgICAgICAgaW5jb21lVG90YWw6IHRoaXMuaW5jb21lVG90YWxcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xlYXJBbGxEYXRhKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRvdGFsID0gMDtcbiAgICAgICAgdGhpcy5hbGxFeHAgPSBbXTtcbiAgICAgICAgdGhpcy5hbGxpbmMgPSBbXTtcbiAgICAgICAgdGhpcy5leHBlbnNlVG90YWwgPSAwO1xuICAgICAgICB0aGlzLmluY29tZVRvdGFsID0gMDtcbiAgICB9XG5cbiAgICBjYWxjdWxhdGVUb3RhbHMoKTogdm9pZCB7XG5cbiAgICAgICAgdGhpcy5hbGxFeHAuZm9yRWFjaChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0VG90YWxzKGUuYW1vdW50LCBlLnR5cGUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5hbGxpbmMuZm9yRWFjaChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0VG90YWxzKGUuYW1vdW50LCBlLnR5cGUpXG4gICAgICAgIH0pXG5cblxuICAgIH1cblxuICAgIGdldEFsbEV4cCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsRXhwXG4gICAgfVxuXG4gICAgZ2V0QWxsSW5jKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hbGxpbmNcbiAgICB9XG5cblxuXG4gICAgc2F2ZURhdGFUb0FycihpZCwgdXNlcklkLCBkYXRlOiBzdHJpbmcgfCBEYXRlLCBkZXNjOiBzdHJpbmcsIGFtb3VudDogbnVtYmVyLCB0eXBlOiBzdHJpbmcpOiB2b2lkIHtcblxuICAgICAgICBjb25zb2xlLmxvZyhkYXRlKVxuICAgICAgICAvLyBsZXQgYnVkZ2V0SXRlbSA9IG5ldyBCdWRnZXRJdGVtKHRoaXMudXVpZCgpLG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZW4tVVNcIiksZGVzYyxhbW91bnQsdHlwZSlcbiAgICAgICAgbGV0IGJ1ZGdldEl0ZW0gPSBuZXcgQnVkZ2V0SXRlbShpZCwgdXNlcklkLCBkYXRlLCBkZXNjLCBhbW91bnQsIHR5cGUpXG5cbiAgICAgICAgLy8gUHVzaCBidWRnZXRJdGVtIHRvIGFycmF5XG4gICAgICAgIGlmICh0eXBlID09ICdleHBlbnNlJykge1xuICAgICAgICAgICAgdGhpcy5hbGxFeHAucHVzaChidWRnZXRJdGVtKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUgPT0gJ2luY29tZScpIHtcbiAgICAgICAgICAgIHRoaXMuYWxsaW5jLnB1c2goYnVkZ2V0SXRlbSlcbiAgICAgICAgfVxuXG5cblxuICAgIH1cblxufSIsImltcG9ydCB7QnVkZ2V0RGF0YUludGVyZmFjZSxGb3JtSW50ZXJmYWNlLEJ1ZGdldFVpSW50ZXJmYWNlfSBmcm9tIFwiLi4vSW50ZXJmYWNlcy9JbnRlcmZhY2VzXCJcblxuXG5leHBvcnQgY2xhc3MgTG9naW5Gb3JtIGltcGxlbWVudHMgRm9ybUludGVyZmFjZXtcbiAgICBcbiAgICBlbWFpbDpzdHJpbmcgfCB1bmRlZmluZWRcbiAgICBwYXNzd29yZDpzdHJpbmcgfCB1bmRlZmluZWRcblxuICAgIGNvbnN0cnVjdG9yKGVtYWlsLHBhc3N3b3JkKXtcbiAgICAgICAgdGhpcy5lbWFpbCA9IGVtYWlsO1xuICAgICAgICB0aGlzLnBhc3N3b3JkID0gcGFzc3dvcmRcbiAgICB9XG59IiwiaW1wb3J0IHsgTG9naW5Gb3JtIH0gZnJvbSBcIi4vTG9naW5Gb3JtTW9kZWxcIlxuXG5leHBvcnQgY2xhc3MgUmVnaXN0ZXJGb3JtIGV4dGVuZHMgTG9naW5Gb3Jte1xuICAgIGNvbmZpcm1QYXNzd29yZDogc3RyaW5nIHwgdW5kZWZpbmVkXG4gICAgLy9BZGQgY29uZmlybSBwYXNzd29yZFxufVxuIiwiaW1wb3J0IHsgTG9naW5Gb3JtIH0gZnJvbSBcIi4uL01vZGVscy9Mb2dpbkZvcm1Nb2RlbFwiO1xuaW1wb3J0IHsgUmVnaXN0ZXJGb3JtIH0gZnJvbSBcIi4uL01vZGVscy9SZWdpc3RlckZvcm1Nb2RlbFwiO1xuXG5cblxuLy9DbGFzc2VkIHVzZWQgZm9yIHVzZXIgc2lnbiBpbiBhbmQgcmVnaXN0cmF0aW9uXG5cbmV4cG9ydCBjbGFzcyBVc2VyRGFse1xuICAgIGFwaVVybDpzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihhcGlVcmw6c3RyaW5nKXtcbiAgICAgICAgdGhpcy5hcGlVcmwgPSBhcGlVcmw7XG4gICAgfVxuXG4gICAgUmVnaXN0ZXJVc2VyKGRhdGE6UmVnaXN0ZXJGb3JtKTp2b2lke1xuICAgICAgICAvL0dldCBkYXRhIGZyb20gZm9ybSB0byBwYXNzIHRvIGFwaVxuXG4gICAgICAgIGZldGNoKHRoaXMuYXBpVXJsLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICdlbWFpbCc6IGRhdGEuZW1haWwsXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzpkYXRhLnBhc3N3b3JkXG5cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXG4gICAgICAgICAgICBcbn0gXG5cbkxvZ2luVXNlcihkYXRhOkxvZ2luRm9ybSk6UHJvbWlzZTxudW1iZXI+e1xuICAgIC8vR2V0IGRhdGEgZnJvbSBmb3JtIHRvIHBhc3MgdG8gYXBpXG5cbiAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vbG9jYWxob3N0OjcyNDIvYXBpL1VzZXJzL2dldF91c2VyX2lkYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGVtYWlsOiBkYXRhLmVtYWlsLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ZGF0YS5wYXNzd29yZFxuXG4gICAgICAgIH0pLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbigocmVzKSA9PiByZXMuanNvbigpKVxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcblxuICAgICAgICBcbn0gXG4gICAgXG59IiwiaW1wb3J0IHsgQnVkZ2V0SXRlbSB9IGZyb20gXCIuLi9Nb2RlbHMvQnVkZ2V0SXRlbU1vZGVsXCI7XG5pbXBvcnQgeyBCdWRnZXREYXRhSW50ZXJmYWNlIH0gZnJvbSBcIi4uL0ludGVyZmFjZXMvSW50ZXJmYWNlc1wiO1xuXG4gY2xhc3MgQXBwU3RhdGUge1xuXG4gICAgdXNlcklkOm51bWJlcjtcbiAgICBhbGxFeHA6IEJ1ZGdldERhdGFJbnRlcmZhY2VbXTtcbiAgICBhbGxJbmM6IEJ1ZGdldERhdGFJbnRlcmZhY2VbXTtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGV4cGVuc2VUb3RhbDogbnVtYmVyO1xuICAgIGluY29tZVRvdGFsOiBudW1iZXI7XG5cbiAgICBzZXRVc2VySWQodXNlcklkOm51bWJlcik6dm9pZHtcbiAgICAgICAgdGhpcy51c2VySWQgPSB1c2VySWQ7XG4gICAgfVxuICAgIHNldEFsbEV4cChhbGxFeHA6QnVkZ2V0SXRlbVtdKXtcbiAgICAgICAgdGhpcy5hbGxFeHAgPSBhbGxFeHA7XG4gICAgfVxuICAgIHNldEFsbEluYyhhbGxJbmM6QnVkZ2V0SXRlbVtdKXtcbiAgICAgICAgdGhpcy5hbGxJbmMgPSBhbGxJbmM7XG4gICAgfVxuXG4gICAgc2V0VG90YWwodG90YWw6bnVtYmVyKXtcbiAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgIH1cblxuXG4gICAgXG5cblxufVxuXG5leHBvcnQgY29uc3QgYXBwU3RhdGUgPSBuZXcgQXBwU3RhdGUoKTsiLCJpbXBvcnQgeyBCdWRnZXRJdGVtIH0gZnJvbSBcIi4vTW9kZWxzL0J1ZGdldEl0ZW1Nb2RlbFwiO1xuaW1wb3J0IHsgTG9naW5Gb3JtIH0gZnJvbSBcIi4vTW9kZWxzL0xvZ2luRm9ybU1vZGVsXCI7XG5pbXBvcnQgeyBSZWdpc3RlckZvcm0gfSBmcm9tIFwiLi9Nb2RlbHMvUmVnaXN0ZXJGb3JtTW9kZWxcIjtcbmltcG9ydCB7IFVzZXJEYWwgfSBmcm9tIFwiLi9EQUwvVXNlckRhbFwiO1xuaW1wb3J0ICBBcGlFbmRwb2ludHMgIGZyb20gXCIuL0RBTC9BcGlFbmRQb2ludHNcIjtcbmltcG9ydCB7IFZpZXcgfSBmcm9tIFwiLi92aWV3XCI7XG5pbXBvcnQgeyBEYXRhQWNjZXNzTGF5ZXIgfSBmcm9tIFwiLi9EQUwvQnVkZ2V0RGFsXCI7XG5pbXBvcnQgeyBNb2RlbCB9IGZyb20gXCIuL21vZGVsXCI7XG5pbXBvcnQgeyBhcHBTdGF0ZSB9IGZyb20gXCIuL1N0b3JlL0FwcFN0YXRlXCI7XG5cblxuZXhwb3J0IGNsYXNzIFVzZXJGb3JtIHtcblxuICAgIHJlZ2lzdGVyRW1haWw6SFRNTEZvcm1FbGVtZW50O1xuICAgIHJlZ2lzdGVyUGFzc3dvcmQ6SFRNTEZvcm1FbGVtZW50O1xuICAgIGxvZ2luRW1haWw6SFRNTEZvcm1FbGVtZW50O1xuICAgIGxvZ2luUGFzc3dvcmQ6SFRNTEZvcm1FbGVtZW50O1xuICAgIHVzZXJEYWwgPSBuZXcgVXNlckRhbChBcGlFbmRwb2ludHMudXNlcnMpO1xuICAgIHZpZXc6VmlldyA9IG5ldyBWaWV3KCk7XG4gICAgbW9kZWw6TW9kZWwgPSBuZXcgTW9kZWwoMCwwLDApXG4gICAgdXNlcklkOnN0cmluZztcbiAgICBcblxuICAgIGNvbnN0cnVjdG9yKHJlZ2lzdGVyRW1haWw6SFRNTEZvcm1FbGVtZW50LHJlZ2lzdGVyUGFzc3dvcmQ6SFRNTEZvcm1FbGVtZW50LGxvZ2luRW1haWw6SFRNTEZvcm1FbGVtZW50LGxvZ2luUGFzc3dvcmQ6SFRNTEZvcm1FbGVtZW50KVxuICAgIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlckVtYWlsID0gcmVnaXN0ZXJFbWFpbDtcbiAgICAgICAgdGhpcy5yZWdpc3RlclBhc3N3b3JkID0gcmVnaXN0ZXJQYXNzd29yZDtcbiAgICAgICAgdGhpcy5sb2dpbkVtYWlsID0gbG9naW5FbWFpbDtcbiAgICAgICAgdGhpcy5sb2dpblBhc3N3b3JkID0gbG9naW5QYXNzd29yZFxuICAgIH1cblxuICAgIGdldFVzZXJJZCgpOnN0cmluZ3tcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlcklkO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRGcm9tRGIoaWQ6c3RyaW5nKSB7XG4gXG5cbiAgICAgICAgbGV0IGRhbDpEYXRhQWNjZXNzTGF5ZXIgPSBuZXcgRGF0YUFjY2Vzc0xheWVyKCk7XG4gICAgICAgIC8vU2F2ZXMgaWQgZnJvbSBkYXRhYmFzZSB0byBvYmplY3QgcHJvcGVydHkgdG8gYmUgdXNlZCBmb3IgZnV0dXJlIHBvc3RzIGFuZCBjYWxsc1xuICAgICAgICB0aGlzLnVzZXJJZCA9IGlkO1xuXG4gICAgICAgIC8vUGFzcyB0aGUgaWQgdG8gdGhlIGRhbFxuXG4gICAgICAgIChhd2FpdCBkYWwuZ2V0KCkpLmZvckVhY2goKGU6QnVkZ2V0SXRlbSkgPT4ge1xuICAgICAgICAgIHRoaXMubW9kZWwuc2F2ZURhdGFUb0FycihlLmlkLHRoaXMudXNlcklkLCBlLmRhdGUsIGUuZGVzY3JpcHRpb24sIGUuYW1vdW50LCBlLnR5cGUpXG4gICAgICAgICAgdGhpcy52aWV3LmFkZFRvSW5jb21lKHRoaXMubW9kZWwuZ2V0QWxsSW5jKCkpXG4gICAgICAgICAgdGhpcy52aWV3LmFkZFRvRXhwZW5zZSh0aGlzLm1vZGVsLmdldEFsbEV4cCgpKVxuXG4gICAgICAgICAgXG4gICAgICAgICAgXG4gICAgICAgIHRoaXMubW9kZWwuc2V0VG90YWxzKGUuYW1vdW50LGUudHlwZSlcblxuICAgICAgICAgIFxuICAgICAgICB9KVxuXG5cbiAgICAgICAgICBhcHBTdGF0ZS51c2VySWQgPSBwYXJzZUludChpZCk7XG4gICAgICAgICAgYXBwU3RhdGUuYWxsRXhwID0gdGhpcy5tb2RlbC5nZXRBbGxFeHAoKTtcbiAgICAgICAgICBhcHBTdGF0ZS5hbGxJbmMgPSB0aGlzLm1vZGVsLmdldEFsbEluYygpO1xuICAgICAgICAgIGFwcFN0YXRlLnRvdGFsID0gdGhpcy5tb2RlbC5nZXRUb3RhbHMoKS50b3RhbDtcbiAgICAgICAgICBhcHBTdGF0ZS5leHBlbnNlVG90YWwgPSB0aGlzLm1vZGVsLmdldFRvdGFscygpLmV4cGVuc2VUb3RhbDtcbiAgICAgICAgICBhcHBTdGF0ZS5pbmNvbWVUb3RhbCA9IHRoaXMubW9kZWwuZ2V0VG90YWxzKCkuaW5jb21lVG90YWw7XG5cbiAgICAgICAgdGhpcy52aWV3LnNldERpc3BsYXlWYWx1ZSh0aGlzLm1vZGVsLnRvdGFsLHRoaXMubW9kZWwuaW5jb21lVG90YWwsdGhpcy5tb2RlbC5leHBlbnNlVG90YWwpXG4gICAgICAgIFxuICAgICAgIFxuICAgICAgICB0aGlzLm1vZGVsLmV2ZW50TGlzdGVuZXJzRGVsZXRlKCk7XG5cbiAgICBcblxuICAgIH1cblxuICAgIHJlZ2lzdGVyVXNlcigpOnZvaWR7XG4gICAgICAgIC8vR2V0IHVzZXIgaW5wdXQgZnJvbSB2aWV3XG4gICAgICAgIHRoaXMudXNlckRhbC5SZWdpc3RlclVzZXIobmV3IFJlZ2lzdGVyRm9ybSh0aGlzLnJlZ2lzdGVyRW1haWwudmFsdWUsdGhpcy5yZWdpc3RlclBhc3N3b3JkLnZhbHVlKSk7XG4gICAgICAgIFxuXG4gICAgICAgIFxuXG4gICAgICAgIC8vIExvZ2luIGFsbCB0aGUgdXNlciBhZnRlciByZWdpc3RlclxuICAgICAgICAvLyB0aGlzLmxvZ2luRW1haWwuaW5uZXJIVE1MID0gdGhpcy5yZWdpc3RlckVtYWlsLnZhbHVlO1xuICAgICAgICAvLyB0aGlzLmxvZ2luUGFzc3dvcmQuaW5uZXJIVE1MID0gdGhpcy5yZWdpc3RlclBhc3N3b3JkLnZhbHVlO1xuXG4gICAgICAgIC8vIHRoaXMuc2lnblVzZXJJbigpXG5cblxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnVzZXJJZClcblxuICAgICAgICB0aGlzLnZpZXcuY2xlYXJDb2x1bW5zKCk7XG4gICAgICAgIHRoaXMubW9kZWwuY2xlYXJBbGxEYXRhKCk7XG5cbiAgICAgICAgVmlldy5jbG9zZVJlZ2lzdGVyQnRuLmNsaWNrKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2lnblVzZXJJbigpe1xuICAgICAgICAvL0FzeW5jIGNhbGwgdG8gZGF0YSBiYXNlIGFuZCB0aGVuIHJldHVybmVkIElkIGlzIHNldCB0byBKU09OXG4gICAgICAgIHRoaXMudXNlcklkID0gSlNPTi5zdHJpbmdpZnkoYXdhaXQgKHRoaXMudXNlckRhbC5Mb2dpblVzZXIobmV3IExvZ2luRm9ybSh0aGlzLmxvZ2luRW1haWwudmFsdWUsdGhpcy5sb2dpblBhc3N3b3JkLnZhbHVlKSkpKS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnZpZXcuY2xlYXJDb2x1bW5zKCk7XG4gICAgICAgIHRoaXMubW9kZWwuY2xlYXJBbGxEYXRhKCk7XG5cbiAgICAgICAgdGhpcy5sb2FkRnJvbURiKHRoaXMudXNlcklkKTtcblxuICAgICAgICB0aGlzLmxvZ2luRW1haWwudmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmxvZ2luUGFzc3dvcmQudmFsdWUgPSBudWxsO1xuXG4gICAgICAgIC8vIENsb3NlcyBtb2RhbCBhZnRlciBzdWJtaXRcbiAgICAgICAgVmlldy5jbG9zZVNpZ25JbkJ0bi5jbGljaygpO1xuXG4gICAgfVxufSIsImltcG9ydCB7Q29udHJvbGxlcn0gZnJvbSAnLi9jb250cm9sbGVyJ1xuXG4vLyBDb21wbGV0ZWx5IG9iamVjdCBvcmllbnRlZCBwcm9ncmFtLiBObyBmdW5jdGlvbnMgb25seSBvYmplY3QgbWV0aG9kcyBhbGxvd2VkLlxuXG5jb25zdCBjb250cm9sbGVyID0gbmV3IENvbnRyb2xsZXIoKTtcblxuXG5jb250cm9sbGVyLmluaXQoKTtcblxuXG5cbiIsImltcG9ydCB7XG4gIFZpZXdcbn0gZnJvbSAnLi92aWV3J1xuaW1wb3J0IHtcbiAgTW9kZWxcbn0gZnJvbSAnLi9tb2RlbCdcbmltcG9ydCB7XG4gIERhdGFBY2Nlc3NMYXllclxufSBmcm9tIFwiLi9EQUwvQnVkZ2V0RGFsXCJcblxuXG5pbXBvcnQgeyBCdWRnZXRJdGVtIH0gZnJvbSAnLi9Nb2RlbHMvQnVkZ2V0SXRlbU1vZGVsJztcblxuaW1wb3J0IHtVc2VyRm9ybX0gZnJvbSBcIi4vdXNlckZvcm1cIjtcbmltcG9ydCBBcGlFbmRQb2ludHMgZnJvbSAnLi9EQUwvQXBpRW5kUG9pbnRzJztcbmltcG9ydCB7IGFwcFN0YXRlIH0gZnJvbSAnLi9TdG9yZS9BcHBTdGF0ZSc7XG5cblxuXG5cblxuZXhwb3J0IGNsYXNzIENvbnRyb2xsZXIge1xuXG4gIG1vZGVsOiBNb2RlbCA9IG5ldyBNb2RlbCgwLCAwLCAwKTtcbiAgdmlldzogVmlldyA9IG5ldyBWaWV3KCk7XG4gIHVzZXJJZDpudW1iZXI7XG4gIGFwaVVybEJ1ZGdldDpzdHJpbmcgPSBBcGlFbmRQb2ludHMuYnVkZ2V0O1xuICBkYWw6IERhdGFBY2Nlc3NMYXllciA9IG5ldyBEYXRhQWNjZXNzTGF5ZXIoKTtcbiAgdXNlckZvcm06IFVzZXJGb3JtID0gbmV3IFVzZXJGb3JtKFZpZXcuZW1haWxfcmVnaXN0ZXIsVmlldy5wYXNzd29yZF9yZWdpc3RlcixWaWV3LmVtYWlsX2xvZ2luLFZpZXcucGFzc3dvcmRfbG9naW4pO1xuXG4gXG5cbiAgZ3Vlc3RNb2RlKCk6dm9pZHtcbiAgICAvLyBXaWxsIGNvbnRhaW4gdGhlIG1ldGhvZHMgdGhhdCB3aWxsIG5vdCBwZXJzaXN0IHRvIGRhdGFiYXNlXG5cbiAgfVxuXG5cbiAgdXNlckFjY291bnRNb2RlKCk6dm9pZHtcbiAgICAvLyBXaWxsIGNvbnRhaW4gbWV0aG9kcyB0aGF0IHdpbGwgaGFuZGxlIHVzZXIgYWNjb3VudFxuICB9XG5cbiAgc3luY01vZGVsV2l0aFN0YXRlKClcbiAge1xuICAgIHRoaXMubW9kZWwudXNlcklkID0gYXBwU3RhdGUudXNlcklkXG4gICAgdGhpcy5tb2RlbC5hbGxFeHAgPSBhcHBTdGF0ZS5hbGxFeHA7XG4gICAgdGhpcy5tb2RlbC5hbGxpbmMgPSBhcHBTdGF0ZS5hbGxJbmM7XG4gICAgdGhpcy5tb2RlbC50b3RhbCA9IGFwcFN0YXRlLnRvdGFsO1xuICAgIHRoaXMubW9kZWwuaW5jb21lVG90YWwgPSBhcHBTdGF0ZS5pbmNvbWVUb3RhbDtcbiAgICB0aGlzLm1vZGVsLmV4cGVuc2VUb3RhbCA9IGFwcFN0YXRlLmV4cGVuc2VUb3RhbDtcbiAgfVxuXG4gIHN5bmNTdGF0ZVdpdGhNb2RlbCgpXG4gIHtcbiAgICBhcHBTdGF0ZS51c2VySWQgID0gdGhpcy5tb2RlbC51c2VySWRcbiAgICBhcHBTdGF0ZS5hbGxFeHAgPSB0aGlzLm1vZGVsLmFsbEV4cDtcbiAgICBhcHBTdGF0ZS5hbGxJbmMgPSB0aGlzLm1vZGVsLmFsbGluYztcbiAgICBhcHBTdGF0ZS50b3RhbCA9IHRoaXMubW9kZWwudG90YWw7XG4gICAgYXBwU3RhdGUuaW5jb21lVG90YWwgPSB0aGlzLm1vZGVsLmluY29tZVRvdGFsO1xuICAgIGFwcFN0YXRlLmV4cGVuc2VUb3RhbCA9IHRoaXMubW9kZWwuZXhwZW5zZVRvdGFsO1xuICB9XG5cbiAgYXN5bmMgcG9zdFRvRGIoKXtcbiAgICBsZXQgYW1vdW50ID0gcGFyc2VJbnQoVmlldy5hbW91bnREb20udmFsdWUpO1xuXG4gIC8vV2FpdHMgZm9yIGRhdGFiYXNlIHRvIHBvc3RcbiAgICBhd2FpdCB0aGlzLmRhbC5wb3N0KG5ldyBCdWRnZXRJdGVtKG51bGwsdGhpcy5tb2RlbC51c2VySWQsbnVsbCxWaWV3LmRlc2NyaXB0aW9uRG9tLnZhbHVlLCBhbW91bnQsIFZpZXcudHlwZS52YWx1ZSkpO1xuXG4gICAgLy9BZnRlciB3YWl0aW5nIGZvciBkYXRhYmFzZSBncmFicyB0aGUgbGFzdCBpdGVtIHdpdGggZGF0YSBhc3NpZ25lZCBmcm9tIERhdGFiYXNlXG4gICAgdGhpcy5nZXRMYXN0SXRlbSgpO1xuXG4gICAgXG4gICAgXG4gIH1cblxuICBnZXRMYXN0SXRlbSgpOnZvaWR7XG4gICAgbGV0IGFtb3VudCA9IHBhcnNlSW50KFZpZXcuYW1vdW50RG9tLnZhbHVlKTtcblxuICAgIHRoaXMuZGFsLmdldExhc3RJdGVtKHRoaXMubW9kZWwudXNlcklkKS50aGVuKChlOkJ1ZGdldEl0ZW0pID0+IHtcblxuXG4gICAgICAvLyBQYXNzIHZhbHVlcyB0byBtb2RlbCB0byBiZSBjcmVhdGVkIGludG8gYSBvYmplY3QgYW5kIHNhdmVkIGluIGFycmF5XG4gICAgICAgICB0aGlzLm1vZGVsLnNhdmVEYXRhVG9BcnIoZS5pZCxlLnVzZXJJZCxlLmRhdGUsZS5kZXNjcmlwdGlvbiwgZS5hbW91bnQsIGUudHlwZSk7XG5cbiAgICAgICAgIC8vVG90YWxzIGFyZSBzZXQgdG8gYmUgdXNlZCBpbiB0aGUgZGlzcGxheSBhbmQgZm9yIG90aGVyIGNhbGN1bGF0aW9uc1xuICAgICAgICAgdGhpcy5tb2RlbC5zZXRUb3RhbHMoYW1vdW50LCBWaWV3LnR5cGUudmFsdWUpO1xuXG4gICAgICAgICAvL1RoZSBkaXNwbGF5IGlzIHNldCB3aXRoIGFsbCBvZiB0aGUgdmFsdWVzXG4gICAgICAgICB0aGlzLnZpZXcuc2V0RGlzcGxheVZhbHVlKHRoaXMubW9kZWwudG90YWwsIHRoaXMubW9kZWwuaW5jb21lVG90YWwsIHRoaXMubW9kZWwuZXhwZW5zZVRvdGFsKTtcblxuICAgICAgICAgLy9JbmNvbWUgYXJyYXkgaXMgcGFzc2VkIHRvIHRoZSBJbmNvbWUgQ29sdW1uXG4gICAgICAgICB0aGlzLnZpZXcuYWRkVG9JbmNvbWUodGhpcy5tb2RlbC5nZXRBbGxJbmMoKSlcblxuICAgICAgICAgLy9FeHBlbnNlIGFycmF5IGlzIHBhc3NlZCB0byB0aGUgRXhwZW5zZSBDb2x1bW5cbiAgICAgICAgIHRoaXMudmlldy5hZGRUb0V4cGVuc2UodGhpcy5tb2RlbC5nZXRBbGxFeHAoKSlcblxuICAgICAgICAgdGhpcy5zeW5jU3RhdGVXaXRoTW9kZWwoKVxuXG4gICAgICAgICBjb25zb2xlLmxvZyhhcHBTdGF0ZSlcblxuICAgICAgICAgdGhpcy5tb2RlbC5ldmVudExpc3RlbmVyc0RlbGV0ZSgpO1xuXG4gICB9KTtcbiAgfVxuXG5cblxuICAvL2NyZWF0ZSBzdWJtaXQgZXZlbnQgbGlzdGVuZXJcblxuICBpbml0KCk6IHZvaWQge1xuICAgXG4gICAgLy8gR2V0IGNhbGN1bGF0aW9uIGlucHV0cyBhbmQgcHV0IGludG8gdG90YWxcblxuICAgIHRoaXMudmlldy5zZXREaXNwbGF5VmFsdWUodGhpcy5tb2RlbC50b3RhbCwgdGhpcy5tb2RlbC5pbmNvbWVUb3RhbCwgdGhpcy5tb2RlbC5leHBlbnNlVG90YWwpO1xuXG4gICAgLy8gU3VibWl0IGJ1dHRvblxuICAgIFZpZXcuc3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cbiAgICAgIHRoaXMuc3luY01vZGVsV2l0aFN0YXRlKClcbiAgICBcbiAgICAgIFZpZXcuc3VibWl0LmRpc2FibGVkID0gdHJ1ZVxuXG4gICAgICAvL1NhdmVzIHVzZXJJZCBmcm9tIGZvcm0gdG8gbW9kZWwgdG8gZ2V0IHN5bmNlZCB1cCB3aXRoIEFwcFN0YXRlXG4gICAgICB0aGlzLm1vZGVsLnVzZXJJZCA9IHBhcnNlSW50KHRoaXMudXNlckZvcm0uZ2V0VXNlcklkKCkpXG5cbiAgICAgIC8vUG9zdCB0byBkYXRhYmFzZSBhbmQgdGhlbiBnZXRzIGl0IGZyb20gZGF0YWJhc2Ugc28gaXQgd2lsbCBoYXZlIGFuIElkIGFuZCBkYXRlIGFzc2lnbmVkIHRvIGl0XG4gICAgIHRoaXMucG9zdFRvRGIoKTtcblxuICAgICBcbiAgIFxuICAgIH0pO1xuXG4gICAgVmlldy5kZXNjcmlwdGlvbkRvbS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBcbiAgICAgIFZpZXcuZm9ybVZhbGlkYXRpb24oKVxuICB9KTtcbiAgXG4gICAgVmlldy5hbW91bnREb20uYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgVmlldy5mb3JtVmFsaWRhdGlvbigpXG4gIH0pO1xuICBcbiAgICBWaWV3LnN1Ym1pdC5kaXNhYmxlZCA9IHRydWVcblxuXG5cbiAgICBWaWV3LnN1Ym1pdF91c2VyX3JlZ2lzdGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT57XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLnVzZXJGb3JtLnJlZ2lzdGVyVXNlcigpO1xuICAgICAgY29uc29sZS5sb2codGhpcy51c2VyRm9ybSk7XG4gICAgICBcbiAgICB9KVxuXG4gICAgVmlldy5zdWJtaXRfdXNlcl9sb2dpbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwoZSkgPT57XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLnVzZXJGb3JtLnNpZ25Vc2VySW4oKTtcblxuICAgICAgXG4gICAgICAvL0NhcHR1cmUgdXNlcklkXG5cbiAgICB9KVxuXG4gICAgXG5cblxuXG4gIH1cbn1cblxuIl0sIm5hbWVzIjpbIlZpZXciLCJzZXREaXNwbGF5VmFsdWUiLCJtYWluRGlzcGxheSIsImluY29tZVRvdGFsIiwiZXhwZW5zZVRvdGFsIiwibWFpbkRpc3BsYXlEb20iLCJpbm5lckhUTUwiLCJ0b1N0cmluZyIsImRpc3BsYXlJbmNvbWVUb3RhbCIsImRpc3BsYXlFeHBlbnNlVG90YWwiLCJhZGRCdWRnZXRJdGVtcyIsImRhdGEiLCJ0eXBlIiwiY29uc29sZSIsImxvZyIsImNsZWFyRmllbGQiLCJkZXNjcmlwdGlvbkRvbSIsInZhbHVlIiwiYW1vdW50RG9tIiwiZm9jdXMiLCJzdGF0aWMiLCJzdWJtaXQiLCJkaXNhYmxlZCIsImJ1ZGdldENhcmRIdG1sIiwiaW5jb21lIiwiaWQiLCJkZXNjcmlwdGlvbiIsImFtb3VudCIsImFkZFRvSW5jb21lIiwibGVuZ3RoIiwiaW5jb21lQ29sdW1uIiwiZm9yRWFjaCIsImUiLCJ0aGlzIiwiY2xlYXJDb2x1bW5zIiwiZXhwZW5zZUNvbHVtbiIsImFkZFRvRXhwZW5zZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbWFpbF9sb2dpbiIsImVtYWlsX3JlZ2lzdGVyIiwicGFzc3dvcmRfbG9naW4iLCJwYXNzd29yZF9yZWdpc3RlciIsInN1Ym1pdF91c2VyX3JlZ2lzdGVyIiwic3VibWl0X3VzZXJfbG9naW4iLCJjbG9zZVNpZ25JbkJ0biIsImNsb3NlUmVnaXN0ZXJCdG4iLCJCdWRnZXRJdGVtIiwiY29uc3RydWN0b3IiLCJ1c2VySWQiLCJkYXRlIiwiZGVzYyIsIkRhdGFBY2Nlc3NMYXllciIsImdldCIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJnZXRMYXN0SXRlbSIsInB1dCIsIml0ZW0iLCJwb3N0IiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicmVzIiwiZGVsZXRlIiwiTW9kZWwiLCJ0b3RhbCIsImRhbCIsInV1aWQiLCJyZXBsYWNlIiwiYyIsInIiLCJNYXRoIiwicmFuZG9tIiwiYWxsRXhwIiwiYWxsaW5jIiwic2V0VG90YWxzIiwiaW5jb21lRGVsZXRlIiwiaW5kZXgiLCJjaGlsZHJlbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXJzZUludCIsInNwbGl0IiwiaXRlbUluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsInJlbW92ZUNoaWxkIiwiZXhwZW5zZURlbGV0ZSIsImV2ZW50TGlzdGVuZXJzRGVsZXRlIiwiZ2V0VG90YWxzIiwiY2xlYXJBbGxEYXRhIiwiY2FsY3VsYXRlVG90YWxzIiwiZ2V0QWxsRXhwIiwiZ2V0QWxsSW5jIiwic2F2ZURhdGFUb0FyciIsImJ1ZGdldEl0ZW0iLCJwdXNoIiwiTG9naW5Gb3JtIiwiZW1haWwiLCJwYXNzd29yZCIsIlJlZ2lzdGVyRm9ybSIsIlVzZXJEYWwiLCJhcGlVcmwiLCJSZWdpc3RlclVzZXIiLCJMb2dpblVzZXIiLCJhcHBTdGF0ZSIsInNldFVzZXJJZCIsInNldEFsbEV4cCIsInNldEFsbEluYyIsImFsbEluYyIsInNldFRvdGFsIiwiVXNlckZvcm0iLCJyZWdpc3RlckVtYWlsIiwicmVnaXN0ZXJQYXNzd29yZCIsImxvZ2luRW1haWwiLCJsb2dpblBhc3N3b3JkIiwidXNlckRhbCIsInZpZXciLCJtb2RlbCIsImdldFVzZXJJZCIsImxvYWRGcm9tRGIiLCJyZWdpc3RlclVzZXIiLCJjbGljayIsInNpZ25Vc2VySW4iLCJhcGlVcmxCdWRnZXQiLCJ1c2VyRm9ybSIsImd1ZXN0TW9kZSIsInVzZXJBY2NvdW50TW9kZSIsInN5bmNNb2RlbFdpdGhTdGF0ZSIsInN5bmNTdGF0ZVdpdGhNb2RlbCIsInBvc3RUb0RiIiwiaW5pdCIsImZvcm1WYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiXSwic291cmNlUm9vdCI6IiJ9